<div class="appointment-container">
  <div class="appointment-header">
    <div class="header-content">
      <div class="logo-section">
        <div class="tooth-logo">
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M50 10 C30 10, 20 20, 20 40 C20 55, 25 70, 30 85 C32 90, 35 95, 40 95 C42 95, 43 93, 44 90 C46 85, 47 80, 48 75 C49 80, 50 85, 52 90 C53 93, 54 95, 56 95 C58 95, 60 93, 62 90 C64 85, 65 80, 66 75 C67 80, 68 85, 70 90 C71 93, 72 95, 74 95 C76 95, 78 93, 80 90 C82 85, 83 80, 84 75 L85 60 C88 45, 90 30, 85 20 C80 12, 70 10, 50 10 Z"
              fill="white" stroke="#a8d8ea" stroke-width="2" />
          </svg>
        </div>
        <h1>SmileCare</h1>
      </div>
      <div class="header-actions">
        <a routerLink="/timer" class="timer-link">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
          Cronómetro
        </a>
        <button class="logout-btn" (click)="logout()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
          Cerrar Sesión
        </button>
      </div>
    </div>

    <div class="form-wrapper">
      <div class="form-card">
        <div class="form-header">
          <div class="tooth-icon" [class.sad]="toothMood === 'sad'" [class.happy]="toothMood === 'happy'">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
              <!-- Diente -->
              <path class="tooth-body"
                d="M50 15 C35 15, 25 22, 25 38 C25 50, 28 62, 32 74 C34 79, 36 83, 40 83 C42 83, 43 81, 44 78 C45 74, 46 70, 47 66 C48 70, 49 74, 50 78 C51 81, 52 83, 54 83 C56 83, 58 81, 59 78 C60 74, 61 70, 62 66 C63 70, 64 74, 65 78 C66 81, 67 83, 69 83 C71 83, 73 81, 75 78 C76 74, 77 70, 78 66 L79 54 C81 42, 82 30, 78 22 C74 17, 65 15, 50 15 Z"
                fill="#a8d8ea" stroke="#6fb3d2" stroke-width="2" />

              <!-- Ojos -->
              <circle class="eye left-eye" cx="40" cy="38" r="3" fill="#2c5f7f" />
              <circle class="eye right-eye" cx="60" cy="38" r="3" fill="#2c5f7f" />

              <!-- Boca feliz -->
              <path class="mouth happy-mouth" d="M 38 50 Q 50 58, 62 50" stroke="#2c5f7f" stroke-width="2.5" fill="none"
                stroke-linecap="round" />

              <!-- Boca triste -->
              <path class="mouth sad-mouth" d="M 38 58 Q 50 50, 62 58" stroke="#2c5f7f" stroke-width="2.5" fill="none"
                stroke-linecap="round" />
            </svg>
          </div>
          <h2>Solicitar Cita</h2>
          <p>Completa el formulario para reservar tu próxima visita</p>
        </div>

        <form (ngSubmit)="onSubmit()" #appointmentForm="ngForm" class="appointment-form">

          <!-- Mensaje de error -->
          <div class="error-message" *ngIf="errorMessage">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="8" x2="12" y2="12"></line>
              <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
            {{ errorMessage }}
          </div>

          <!-- Mensaje de éxito -->
          <div class="success-message" *ngIf="showSuccess">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
            ¡Cita creada con éxito! Te enviaremos un correo de confirmación.
          </div>

          <div class="form-grid">
            <!-- Nombre del Paciente -->
            <div class="form-group">
              <label for="patientName">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                  <circle cx="12" cy="7" r="4"></circle>
                </svg>
                Nombre Completo *
              </label>
              <input type="text" id="patientName" name="patientName" [(ngModel)]="appointment.patientName"
                (ngModelChange)="onFieldChange()" placeholder="Juan Pérez García" required />
            </div>

            <!-- Email -->
            <div class="form-group">
              <label for="email">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                  <polyline points="22,6 12,13 2,6"></polyline>
                </svg>
                Email *
              </label>
              <input type="email" id="email" name="email" [(ngModel)]="appointment.email"
                (ngModelChange)="onFieldChange()" placeholder="ejemplo&#64;email.com" required />
            </div>

            <!-- Teléfono -->
            <div class="form-group">
              <label for="phone">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2">
                  <path
                    d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z">
                  </path>
                </svg>
                Teléfono *
              </label>
              <input type="tel" id="phone" name="phone" [(ngModel)]="appointment.phone"
                (ngModelChange)="onFieldChange()" placeholder="600 123 456" required />
            </div>

            <!-- Tipo de Servicio -->
            <div class="form-group">
              <label for="service">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                Tipo de Servicio *
              </label>
              <select id="service" name="service" [(ngModel)]="appointment.service" (ngModelChange)="onFieldChange()"
                required>
                <option value="" disabled>Selecciona un servicio</option>
                <option *ngFor="let service of services" [value]="service.value">
                  {{ service.label }}
                </option>
              </select>
            </div>

            <!-- Higienista -->
            <div class="form-group">
              <label for="hygienist">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2">
                  <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                  <circle cx="9" cy="7" r="4"></circle>
                  <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                  <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                Higienista *
              </label>
              <select id="hygienist" name="hygienist" [(ngModel)]="appointment.hygienist"
                (ngModelChange)="onFieldChange()" required>
                <option value="" disabled>Selecciona una higienista</option>
                <option *ngFor="let hygienist of hygienists" [value]="hygienist.value">
                  {{ hygienist.label }}
                </option>
              </select>
            </div>

            <!-- Fecha -->
            <div class="form-group">
              <label for="date">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                Fecha *
              </label>
              <input type="date" id="date" name="date" [(ngModel)]="appointment.date" (ngModelChange)="onFieldChange()"
                required />
            </div>

            <!-- Hora -->
            <div class="form-group">
              <label for="time">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                Hora *
              </label>
              <select id="time" name="time" [(ngModel)]="appointment.time" (ngModelChange)="onFieldChange()" required>
                <option value="" disabled>Selecciona una hora</option>
                <option *ngFor="let slot of timeSlots" [value]="slot">
                  {{ slot }}
                </option>
              </select>
            </div>

            <!-- Notas adicionales -->
            <div class="form-group full-width">
              <label for="notes">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
                Notas Adicionales
              </label>
              <textarea id="notes" name="notes" [(ngModel)]="appointment.notes"
                placeholder="Información adicional que quieras compartir..." rows="4"></textarea>
            </div>
          </div>

          <!-- Botón de envío -->
          <div class="form-actions">
            <button type="submit" class="submit-btn" [disabled]="isSubmitting" [class.submitting]="isSubmitting">
              <span *ngIf="!isSubmitting">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2">
                  <polyline points="9 11 12 14 22 4"></polyline>
                  <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                </svg>
                Confirmar Cita
              </span>
              <span *ngIf="isSubmitting" class="loading-spinner">
                <svg width="20" height="20" viewBox="0 0 50 50">
                  <circle cx="25" cy="25" r="20" fill="none" stroke="currentColor" stroke-width="5"
                    stroke-dasharray="31.4 31.4" stroke-linecap="round">
                    <animateTransform attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="1s"
                      repeatCount="indefinite" />
                  </circle>
                </svg>
                Procesando...
              </span>
            </button>
          </div>
        </form>
      </div>

      <!-- Información de contacto -->
      <div class="info-card">
        <h3>Información de Contacto</h3>
        <div class="contact-info">
          <div class="contact-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
              <circle cx="12" cy="10" r="3"></circle>
            </svg>
            <div>
              <h4>Dirección</h4>
              <p>Calle Sonrisa, 123<br>28001 Madrid</p>
            </div>
          </div>
          <div class="contact-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2">
              <path
                d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z">
              </path>
            </svg>
            <div>
              <h4>Teléfono</h4>
              <p>Tel: 910 123 456<br>info&#64;smilecare.es</p>
            </div>
          </div>
          <div class="contact-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
            <div>
              <h4>Horario</h4>
              <p>Lun - Vie: 9:00 - 14:00 y 17:00 - 20:30<br>Sáb: 9:00 - 14:00</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>